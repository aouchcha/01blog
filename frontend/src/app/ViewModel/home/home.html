<div class="home-container">
    <!-- Mobile Header -->
    <header class="mobile-header">
        <button class="mobile-menu-btn" (click)="toggleLeftMenu()">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M3 12h18M3 6h18M3 18h18" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </svg>
        </button>
        <div class="mobile-logo">
            <div class="logo-icon"></div>
            <span>O1Blog</span>
        </div>
        <button class="mobile-menu-btn" (click)="toggleRightMenu()">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M16 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2M8.5 11a4 4 0 100-8 4 4 0 000 8zM20 8v6M23 11h-6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </svg>
        </button>
    </header>

    <!-- Mobile Overlay -->
    <div class="mobile-overlay" *ngIf="leftMenuOpen || rightMenuOpen" (click)="closeMenus()"></div>

    <!-- Left Sidebar - Navigation -->
    <aside class="left-sidebar" [class.mobile-open]="leftMenuOpen">
        <div class="user-info">
            <img src="../../assets/icons/pngtree-outline-user-icon-png-image_5045523.jpg" 
                 alt="avatar" 
                 class="user-avatar" 
                 (click)="ToProfile(me.username)">
            <p class="username">{{me.username}}</p>
        </div>

        <nav class="nav-menu">
            <button class="nav-button active" (click)="getAllPosts()">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M3 4h14M3 10h14M3 16h14" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                </svg>
                <span>News Feed</span>
            </button>
            
            <button class="nav-button">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M16 18v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2M12 6a4 4 0 11-8 0 4 4 0 018 0z" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                </svg>
                <span>Friends</span>
            </button>
            
            <button class="nav-button" (click)="ShowNotif()">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M15 6.5a5 5 0 00-10 0c0 6-3 7.5-3 7.5h16s-3-1.5-3-7.5zM11.73 17a2 2 0 01-3.46 0" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                </svg>
                <span>Notification</span>
                <span class="notification-badge" *ngIf="notifsCount > 0">{{notifsCount}}</span>
            </button>
            
            <button class="nav-button" (click)="ToProfile(me.username)">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M10 10a4 4 0 100-8 4 4 0 000 8zM3 18a7 7 0 0114 0" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                </svg>
                <span>Profile</span>
            </button>
        </nav>
    </aside>

    <!-- Main Content - Feed -->
    <main class="main-content">
        <!-- Notifications Panel -->
        <div class="notifications-panel" *ngIf="ShowNotifs">
            <div class="panel-header">
                <h2>Notifications</h2>
                <button class="close-btn" (click)="CloseNotif()">‚úï</button>
            </div>
            <div class="notifications-list">
                <div class="notification-item">
                    <div class="notification-content">
                        <strong>Sender</strong>
                        <span class="notification-text">Created Post At now</span>
                    </div>
                    <button class="seen-btn">Seen</button>
                </div>
                <div class="notification-item">
                    <div class="notification-content">
                        <strong>Sender</strong>
                        <span class="notification-text">Created Post At now</span>
                    </div>
                    <button class="seen-btn">Seen</button>
                </div>
                <div class="notification-item">
                    <div class="notification-content">
                        <strong>Sender</strong>
                        <span class="notification-text">Created Post At now</span>
                    </div>
                    <button class="seen-btn">Seen</button>
                </div>
            </div>
        </div>

        <!-- Create Post Card -->
        <div class="create-post-card" *ngIf="!ShowNotifs">
            <div class="create-post-header">
                <img src="../../assets/icons/pngtree-outline-user-icon-png-image_5045523.jpg" 
                     alt="avatar" 
                     class="post-avatar">
                <textarea [(ngModel)]="description" 
                          placeholder="Share something..." 
                          class="post-textarea"></textarea>
            </div>
            
            <p class="media-preview" *ngIf="media !== null">
                <b>File to upload: {{mediaName}}</b>
            </p>
            
            <div class="create-post-actions">
                <label for="Media" class="media-btn">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                    Select Media
                </label>
                <input type="file" 
                       id="Media" 
                       (change)="setMedia($event, 'create')" 
                       class="media-input" 
                       accept="image/*, video/*">
                <button class="share-btn" (click)="CreatePost()">Share</button>
                <button class="cancel-btn" (click)="Cancel()">Cancel</button>
            </div>
        </div>

        <!-- Posts Feed -->
        <div class="posts-container" *ngIf="!ShowNotifs">
            <div class="empty-state" *ngIf="!posts || posts.length === 0">
                <p>No posts yet.</p>
            </div>

            <div class="post-card" *ngFor="let post of posts">
                <div class="post-header">
                    <div class="post-user">
                        <img [src]="'assets/icons/pngtree-outline-user-icon-png-image_5045523.jpg'" 
                             alt="User Avatar" 
                             class="post-avatar" 
                             (click)="ToProfile(post.user.username)">
                        <div class="post-user-info">
                            <strong>{{ post.user.username }}</strong>
                            <span class="post-timestamp">{{ post.createdAt | date:'short' }}</span>
                        </div>
                    </div>
                    
                    <button mat-icon-button 
                            [matMenuTriggerFor]="optionsMenu" 
                            matTooltip="Options"
                            *ngIf="post.user.username === me.username" 
                            class="options-btn">
                        <mat-icon>more_vert</mat-icon>
                    </button>
                    <mat-menu #optionsMenu="matMenu">
                        <button mat-menu-item (click)="ShowUpdate(post.id)">
                            <mat-icon>edit</mat-icon>
                            <span>Update</span>
                        </button>
                        <button mat-menu-item (click)="deletePost(post.id)">
                            <mat-icon>delete</mat-icon>
                            <span>Delete</span>
                        </button>
                    </mat-menu>
                </div>

                <div class="post-content">
                    <p>{{ post.description }}</p>
                    <div class="post-media-container" *ngIf="post.media">
                        <ng-container [ngSwitch]="post.mediaUrl?.split('.').pop()">
                            <img *ngSwitchCase="'jpg'" [src]="post.mediaUrl" alt="Post image" class="post-media">
                            <img *ngSwitchCase="'JPG'" [src]="post.mediaUrl" alt="Post image" class="post-media">
                            <img *ngSwitchCase="'jpeg'" [src]="post.mediaUrl" alt="Post image" class="post-media">
                            <img *ngSwitchCase="'png'" [src]="post.mediaUrl" alt="Post image" class="post-media">
                            <img *ngSwitchCase="'webp'" [src]="post.mediaUrl" alt="Post image" class="post-media">
                            <video *ngSwitchCase="'mp4'" [src]="post.mediaUrl" controls class="post-media" preload="metadata"></video>
                        </ng-container>
                    </div>
                </div>

                <div class="post-actions">
                    <button class="action-btn" (click)="React(post.id)">
                        ‚ù§Ô∏è {{ post.likeCount || 0 }}
                    </button>
                    <button class="action-btn" (click)="ShowSinglePost(post.id)">
                        üí¨ {{ post.commentsCount || 0 }}
                    </button>
                </div>
            </div>
        </div>

        <!-- Update Post Modal -->
        <div class="modal-overlay" *ngIf="update" (click)="Cancel()">
            <div class="modal-content" (click)="$event.stopPropagation()">
                <div class="modal-header">
                    <h2>Update Post</h2>
                    <button class="modal-close" (click)="Cancel()">‚úï</button>
                </div>
                
                <textarea [(ngModel)]="updatedDescription" 
                          placeholder="Update your description..." 
                          class="modal-textarea"></textarea>

                <label for="UpdateMedia" class="modal-media-btn">Select Media</label>
                <input type="file" 
                       id="UpdateMedia" 
                       (change)="setMedia($event, 'update')" 
                       class="media-input" 
                       accept="image/*, video/*">
                <p class="media-preview" *ngIf="updateMedia !== null">
                    <b>File to upload: {{updatedMediaName}}</b>
                </p>

                <div class="modal-actions">
                    <button class="modal-save-btn" (click)="UpdatePost()">Save</button>
                    <button class="modal-cancel-btn" (click)="Cancel()">Cancel</button>
                </div>
            </div>
        </div>
    </main>

    <!-- Right Sidebar - Suggestions -->
    <aside class="right-sidebar" [class.mobile-open]="rightMenuOpen">
        <div class="sidebar-actions">
            <button class="action-button" (click)="ToProfile(me.username)">Profile</button>
            <button class="action-button logout" (click)="Logout()">Logout</button>
        </div>

        <div class="suggestions-section" *ngIf="others && others.length > 0">
            <h3>Suggestions</h3>
            <div class="suggestion-item" *ngFor="let user of others">
                <p class="suggestion-username" (click)="ToProfile(user.username)">{{user.username}}</p>
                <button class="follow-btn" 
                        [class.following]="user.follow"
                        (click)="Follow(user.id)">
                    {{ user.follow ? 'Unfollow' : 'Follow'}}
                </button>
            </div>
        </div>
    </aside>
</div>