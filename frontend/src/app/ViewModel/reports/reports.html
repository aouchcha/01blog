<div class="reports-container">
    <!-- Header -->
    <header class="reports-header">
        <div class="header-content">
            <div class="header-left">
                <button class="back-button" (click)="ToDashBoard()">
                    <mat-icon>arrow_back</mat-icon>
                    Back to Dashboard
                </button>
                <h1>Reports Management</h1>
            </div>
            <div class="header-stats">
                <div class="stat-badge">
                    <span class="stat-number">{{total || 0}}</span>
                    <span class="stat-label">Total Reports</span>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="reports-main" (scroll)="handleScrollLogic($event)">
        <!-- Empty State -->
        <div class="empty-state" *ngIf="!reports || reports.length === 0">
            <h3>No Reports Found</h3>
            <p>There are currently no reports to review.</p>
        </div>

        <!-- Reports Grid -->
        <div class="reports-grid" *ngIf="reports && reports.length > 0">
            <div class="report-card" *ngFor="let report of reports">
                <!-- Report Header -->
                <div class="report-card-header">
                    <div class="user-section reporter-section">
                        <div class="section-label">Reporter</div>
                        <div class="user-info">
                            <img src="../../assets/icons/pngtree-outline-user-icon-png-image_5045523.jpg" 
                                 alt="Reporter" 
                                 class="user-avatar">
                            <div class="user-details">
                                <span class="user-name">{{ report.repporter.username }}</span>
                                <span class="user-email" *ngIf="report.repporter.email">{{ report.repporter.email }}</span>
                            </div>
                        </div>
                    </div>

                    <div class="divider-vertical"></div>

                    <div class="user-section reported-section">
                        <div class="section-label">Reported</div>
                        <div class="user-info">
                            <img src="../../assets/icons/pngtree-outline-user-icon-png-image_5045523.jpg" 
                                 alt="Reported" 
                                 class="user-avatar">
                            <div class="user-details">
                                <span class="user-name">{{ report.repported.username }}</span>
                                <span class="user-email" *ngIf="report.repported.email">{{ report.repported.email }}</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Report Body -->
                <div class="report-card-body">
                    <div class="description-label">Description</div>
                    <p class="report-description">{{ report.description }}</p>
                </div>

                <!-- Report Footer -->
                <div class="report-card-footer">
                    <div class="report-time" *ngIf="report.createdAt">
                        <mat-icon>access_time</mat-icon>
                        <span>{{ report.createdAt | date:'medium' }}</span>
                    </div>
                    <div class="report-actions">
                        <button class="action-btn view-btn" (click)="ViewDetails(report)">
                            <mat-icon>visibility</mat-icon>
                            Details
                        </button>
                        <button class="action-btn resolve-btn" (click)="CheckBanUser(report.repported.username, report.id)">
                            <mat-icon>gavel</mat-icon>
                            Ban {{report.repported.username}}
                        </button>
                        <button class="action-btn delete-btn" (click)="ConfirmAction(report.id)">
                            <mat-icon>delete</mat-icon>
                            Delete
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Report Details Modal -->
        <div class="modal-overlay" *ngIf="showDetailsModal" (click)="CloseModal()">
            <div class="modal-content" (click)="$event.stopPropagation()">
                <div class="modal-header">
                    <h2>Report Details</h2>
                    <button class="modal-close-btn" (click)="CloseModal()">
                        <mat-icon>close</mat-icon>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="detail-section">
                        <label>Reporter:</label>
                        <div class="detail-user">
                            <img src="../../assets/icons/pngtree-outline-user-icon-png-image_5045523.jpg" 
                                 alt="Reporter" 
                                 class="detail-avatar">
                            <div>
                                <div class="detail-name">{{selectedReport?.repporter.username}}</div>
                                <div class="detail-email" *ngIf="selectedReport?.repporter.email">{{selectedReport?.repporter.email}}</div>
                            </div>
                        </div>
                    </div>
                    <div class="detail-section">
                        <label>Reported User:</label>
                        <div class="detail-user">
                            <img src="../../assets/icons/pngtree-outline-user-icon-png-image_5045523.jpg" 
                                 alt="Reported" 
                                 class="detail-avatar">
                            <div>
                                <div class="detail-name">{{selectedReport?.repported.username}}</div>
                                <div class="detail-email" *ngIf="selectedReport?.repported.email">{{selectedReport?.repported.email}}</div>
                            </div>
                        </div>
                    </div>
                    <div class="detail-section">
                        <label>Description:</label>
                        <p class="detail-description">{{selectedReport?.description}}</p>
                    </div>
                    <div class="detail-section" *ngIf="selectedReport?.createdAt">
                        <label>Reported On:</label>
                        <p class="detail-time">{{selectedReport?.createdAt | date:'full'}}</p>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="modal-btn resolve-modal-btn" (click)="CheckBanUser(selectedReport?.repported.username, selectedReport?.id)">
                        Ban {{selectedReport?.repported.username}}
                    </button>
                    <button class="modal-btn resolve-modal-btn" *ngIf="selectedReport?.type === 'post'" (click)="GoToPost(selectedReport?.post.id)">
                        See Post
                    </button>
                    <button class="modal-btn delete-modal-btn" (click)="ConfirmAction(selectedReport?.id)">
                        Delete Report
                    </button>
                </div>
            </div>
        </div>

         <div class="modal-overlay" *ngIf="showConfirmation" (click)="CancelAction()">
            <app-confirmation [title]="confirmationTitle" [message]="confirmationMessage" [action]="confirmationAction"
                (confirmed)="HandleAction($event)"> </app-confirmation>
        </div>
    </main>
</div>